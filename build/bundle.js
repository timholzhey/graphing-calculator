(()=>{"use strict";var e={85:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDomain=t.canvasDrawFunction=t.driveCanvas=t.canvasDraw=t.resetCanvas=t.getOffset=t.getScale=t.initCanvas=t.mainCanvas=void 0;const o=n(283),r=n(607),a=n(750),l=n(984),s=n(99),i=n(533);t.mainCanvas=document.getElementById("main-canvas");const u=t.mainCanvas.getContext("2d"),c=document.querySelector(".zoom-in-button"),E=document.querySelector(".zoom-out-button"),f=document.querySelector(".fps-display"),T=new o.Vector(0,0);let g=1;const h=16,M=new o.Vector(0,0),d=new o.Vector(0,0);let k=!1,p=!0;const L=function(e){const t=(g*(e>0?1+.2*e:1/(1-.2*e))-g)/10;let n=0;const o=setInterval((function(){g+=t,(0,r.scheduleRedraw)(),n++,n>=10&&clearInterval(o)}),10)};t.initCanvas=function(){t.mainCanvas.addEventListener("mousedown",(function(e){M.set(T.x,T.y),d.set(e.clientX,e.clientY),k=!0})),(0,a.onMouseDrag)(t.mainCanvas,(e=>{k&&(T.x=M.x+e.x-d.x,T.y=M.y+e.y-d.y,(0,r.scheduleRedraw)())})),t.mainCanvas.addEventListener("mouseup",(()=>{k=!1})),t.mainCanvas.addEventListener("mouseleave",(()=>{k=!1})),t.mainCanvas.addEventListener("wheel",(e=>{!function(e){const t=e>0?1+.2*e:1/(1-.2*e);g*=t,T.x*=t,T.y*=t,(0,r.scheduleRedraw)()}(-e.deltaY/200)})),c.addEventListener("click",(()=>{L(1)})),E.addEventListener("click",(()=>{L(-1)})),(0,s.bindExternVariable)("scale",(()=>g),(e=>{g=e,(0,r.scheduleRedraw)()})),(0,s.bindExternVariable)("grid",(()=>p?1:0),(e=>{p=e>0,(0,r.scheduleRedraw)()})),(0,s.bindExternVariable)("offset",(()=>[T.x,T.y]),(e=>{m(e[0],e[1]),(0,r.scheduleRedraw)()})),window.onresize=()=>(0,r.scheduleRedraw)();const e=new URLSearchParams(window.location.search),n=e.get("plot"),o=e.get("scale");n&&(0,i.loadPlots)(n.split(";"),[]),o&&(g=parseFloat(o))};const m=function(e,n){T.x=-e*(t.mainCanvas.width/h),T.y=n*(t.mainCanvas.height/h)};t.getScale=()=>g,t.getOffset=()=>T,t.resetCanvas=function(){g=1,T.set(0,0),(0,r.scheduleRedraw)()},t.canvasDraw=function(){u&&(t.mainCanvas.width=t.mainCanvas.clientWidth,t.mainCanvas.height=t.mainCanvas.clientHeight,u.clearRect(0,0,t.mainCanvas.width,t.mainCanvas.height),I())},t.driveCanvas=function(){f.innerHTML=(0,r.getFPSSmoothed)().toFixed(0)};const R=function(e,t,n,o){u&&(u.beginPath(),u.moveTo(e,t),u.lineTo(n,o),u.stroke())},I=function(){if(!u||!p)return;const e=t.mainCanvas.width,n=t.mainCanvas.height,o=e/n;u.strokeStyle="#fff",u.lineWidth=2,R(e/2+T.x,0,e/2+T.x,n),R(0,n/2+T.y,e,n/2+T.y);const r=Math.pow(2,Math.floor(Math.log(g)/Math.log(2))),a=n/h/r*g;let l=-Math.floor(h/g/2*r)/r-Math.floor(T.y/a)/r-(T.y<0?1/r:0)-1/r;const s=(n%(2*a)-2*a)/2,i=T.y%a;for(let t=0;t<n+2*a;t+=a,l+=1/r)u.strokeStyle="#666",u.lineWidth=.5,R(0,t+s+i,e,t+s+i),u.strokeStyle="transparent",u.fillStyle="#fff",u.textAlign="right",0!==l&&(u.beginPath(),u.fillText((-l).toString(),e/2+T.x-10,t+s+i+4));const c=e/h/r/o*g;let E=-Math.floor(h/g/2*r*o)/r-Math.floor(T.x/c)/r-(T.x<0?1/r:0)-1/r;const f=(e%(2*c)-2*c)/2,M=T.x%c;for(let t=0;t<e+c;t+=c,E+=1/r)u.strokeStyle="#666",u.lineWidth=.5,R(t+f+M,0,t+f+M,n),u.strokeStyle="transparent",u.fillStyle="#fff",u.textAlign="center",0!==E?(u.beginPath(),u.fillText(E.toString(),t+f+M,n/2+T.y+20)):(u.beginPath(),u.fillText((-E).toString(),t+f+M-18,n/2+T.y+20))};t.canvasDrawFunction=function(e,n){if(!u||!e)return;const r=t.mainCanvas.width,a=t.mainCanvas.height,s=r/a;u.strokeStyle=n,u.lineWidth=2.5,u.fillStyle="transparent",u.beginPath();const i=r/h/s*g,c=T.x/i;let E=!0;for(let t=-8*s/g-c;t<8*s/g-c;t+=.01/g){const n=(0,l.constantEvalX)(e,t),i="number"==typeof n?n:n.re;if((0,l.constantEvalGetError)())return;const c=(0,o.map)(t,-8*s/g,8*s/g,0,r)+T.x,f=(0,o.map)(i,-8/g,8/g,a,0)+T.y;E&&(u.moveTo(c,f),E=!1),u.lineTo(c,f)}u.stroke()},t.getDomain=function(){const e=t.mainCanvas.width,n=t.mainCanvas.height,o=e/n,r=e/h/o*g,a=T.x/r,l=-8*o/g-a,s=8*o/g-a,i=n/h*g,u=T.y/i;return{minX:l,maxX:s,minY:-8/g+u,maxY:8/g+u}}},984:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.constantEvalGetError=t.constantEvalX=t.constantEval=void 0;const o=n(607),r=n(99),a=n(750),l=n(283);let s,i=null;t.constantEval=function(e){return e?(i=null,c(e)):0},t.constantEvalX=function(e,n){s=n;const o=(0,t.constantEval)(e);return s=null,o};const u=function(e){return console.error("Error during constant evaluation: "+e),i=e,0};t.constantEvalGetError=()=>i;const c=function(e){var t,n;let i,E;switch(e.op.tok){case r.Token.UNDEF:return u("Token UNDEFINED is not allowed");case r.Token.NONE:return 0;case r.Token.PAREN_OP:return u("Token OPEN PARENTHESIS is not allowed");case r.Token.PAREN_CL:return u("Token CLOSE PARENTHESIS is not allowed");case r.Token.BRACKET_OP:return u("Token OPEN BRACKET is not allowed");case r.Token.BRACKET_CL:return u("Token CLOSE BRACKET is not allowed");case r.Token.BRACE_OP:return u("Token OPEN BRACE is not allowed");case r.Token.BRACE_CL:return u("Token CLOSE BRACE is not allowed");case r.Token.NUM:return"number"!=typeof e.op.val?u("Token NUMBER must be a number"):(0,l.cpx)(e.op.val);case r.Token.CONST:return"number"!=typeof e.op.val?u("Token CONSTANT must be a number"):(0,l.cpx)(e.op.val);case r.Token.VAR:return null==s?u("Token VARIABLE is not defined"):(0,l.cpx)(s);case r.Token.VAR2:return u("Token VARIABLE2 is not allowed");case r.Token.TIME:return(0,o.scheduleRedraw)(),(0,l.cpx)((0,o.getGlobalTime)());case r.Token.ADD:return null==e.left||null==e.right?u("Missing arguments for Token ADDITION"):(i=c(e.left),E=c(e.right),{re:i.re+E.re,im:i.im+E.im});case r.Token.SUB:return null==e.left||null==e.right?u("Missing arguments for Token SUBTRACTION"):(i=c(e.left),E=c(e.right),{re:i.re-E.re,im:i.im-E.im});case r.Token.MULT:return null==e.left||null==e.right?u("Missing arguments for Token MULTIPLICATION"):(i=c(e.left),E=c(e.right),0===i.im&&0===E.im?(0,l.cpx)(i.re*E.re):{re:i.re*E.re-i.im*E.im,im:i.re*E.im+i.im*E.re});case r.Token.DIV:{if(null==e.left||null==e.right)return u("Missing arguments for Token DIVISION");if(i=c(e.left),E=c(e.right),0===E.re&&0===E.im)return u("Division by zero");if(0===i.im&&0===E.im)return(0,l.cpx)(i.re/E.re);const t=E.re*E.re+E.im*E.im;return{re:(i.re*E.re+i.im*E.im)/t,im:(i.im*E.re-i.re*E.im)/t}}case r.Token.POW:{if(null==e.left||null==e.right)return u("Missing arguments for Token POWER");if(i=c(e.left),E=c(e.right),0===i.im&&0===E.im)return(0,l.cpx)(Math.pow(i.re,E.re));if(0!==E.im)return u("Imaginary power is not allowed");const t=Math.sqrt(i.re*i.re+i.im*i.im),n=Math.atan2(i.im,i.re),o=Math.pow(t,E.re),r=E.re*n;return{re:o*Math.cos(r),im:o*Math.sin(r)}}case r.Token.SQRT:return null==e.right?u("Missing argument for Token SQUARE ROOT"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.sqrt(E.re)):u("SQUARE ROOT is not defined for complex numbers"));case r.Token.LOG:return null==e.right?u("Missing argument for Token LOGARITHM"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.log(E.re)):u("LOGARITHM is not defined for complex numbers"));case r.Token.EXP:return null==e.right?u("Missing argument for Token EXPOENTIAL"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.exp(E.re)):{re:Math.exp(E.re)*Math.cos(E.im),im:Math.exp(E.re)*Math.sin(E.im)});case r.Token.SIN:return null==e.right?u("Missing argument for Token SINE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.sin(E.re)):{re:Math.sin(E.re)*Math.cosh(E.im),im:Math.cos(E.re)*Math.sinh(E.im)});case r.Token.COS:return null==e.right?u("Missing argument for Token COSINE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.cos(E.re)):{re:Math.cos(E.re)*Math.cosh(E.im),im:-Math.sin(E.re)*Math.sinh(E.im)});case r.Token.TAN:return null==e.right?u("Missing argument for Token TANGENT"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.tan(E.re)):{re:Math.sin(2*E.re)/(Math.cos(2*E.re)+Math.cosh(2*E.im)),im:Math.sinh(2*E.im)/(Math.cos(2*E.re)+Math.cosh(2*E.im))});case r.Token.ASIN:return null==e.right?u("Missing argument for Token ARC SINE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.asin(E.re)):{re:Math.log(E.re+Math.sqrt(1-E.re*E.re)),im:Math.sign(E.im)*Math.sqrt(1-E.re*E.re)});case r.Token.SINH:return null==e.right?u("Missing argument for Token SINE HYPERBOLICUS"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.sinh(E.re)):{re:Math.cosh(E.re)*Math.cos(E.im),im:Math.sinh(E.re)*Math.sin(E.im)});case r.Token.COSH:return null==e.right?u("Missing argument for Token COSINE HYPERBOLICUS"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.cosh(E.re)):{re:Math.cosh(E.re)*Math.cos(E.im),im:Math.sinh(E.re)*Math.sin(E.im)});case r.Token.TANH:return null==e.right?u("Missing argument for Token TANGENT HYPERBOLICUS"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.tanh(E.re)):{re:Math.cosh(2*E.re)/(Math.cos(2*E.re)+Math.cosh(2*E.im)),im:Math.sinh(2*E.im)/(Math.cos(2*E.re)+Math.cosh(2*E.im))});case r.Token.ACOS:return null==e.right?u("Missing argument for Token ARC COSINE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.acos(E.re)):{re:Math.log(E.re+Math.sqrt(1-E.re*E.re)),im:-Math.sign(E.im)*Math.sqrt(1-E.re*E.re)});case r.Token.ATAN:return null==e.right?u("Missing argument for Token ARC TANGENT"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.atan(E.re)):{re:Math.atan(E.re/E.im),im:Math.log((1+E.im)/(1-E.im))/2});case r.Token.FLOOR:return null==e.right?u("Missing argument for Token FLOOR"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.floor(E.re)):u("FLOOR is not defined for complex numbers"));case r.Token.MIN:{if(null==e.right)return u("Missing argument for Token MIN");if(!(0,l.isIterable)(c(e.right)))return u("Malformed argument for Token MIN");const t=[...c(e.right)];return(0,l.cpx)(Math.min(...t))}case r.Token.MAX:{if(null==e.right)return u("Missing argument for Token MAX");if(!(0,l.isIterable)(c(e.right)))return u("Malformed argument for Token MAX");const t=[...c(e.right)];return(0,l.cpx)(Math.max(...t))}case r.Token.DELIM:{if(null==e.left||null==e.right)return u("Missing arguments for Token DELIMITER");i=c(e.left),E=c(e.right);const t=[];return"number"==typeof(null==i?void 0:i.re)?t.push(null==i?void 0:i.re):t.concat(null==i?void 0:i.re),"number"==typeof(null==E?void 0:E.re)?t.push(null==E?void 0:E.re):t.concat(null==E?void 0:E.re),t}case r.Token.ABS:return null==e.right?u("Missing argument for Token ABSOLUTE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.abs(E.re)):(0,l.cpx)(Math.sqrt(E.re*E.re+E.im*E.im)));case r.Token.RAND:return null==e.right?u("Missing argument for Token RANDOM"):(0,l.cpx)(Math.random()*c(e.right));case r.Token.PERLIN:{if(null==e.right)return u("Missing arguments for Token PERLIN");if(!(0,l.isIterable)(c(e.right)))return u("Malformed argument for Token PERLIN");const[t,n]=c(e.right);return(0,l.cpx)((0,l.perlin2)(t,n))}case r.Token.MOD:return null==e.left||null==e.right?u("Missing arguments for Token MODULUS"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re%E.re):u("MODULUS is not defined for complex numbers"));case r.Token.LEVEL_SET:return u("Token LEVEL SET is not allowed");case r.Token.VECTOR_FIELD:return u("Token VECTOR FIELD is not allowed");case r.Token.LESS:return null==e.left||null==e.right?u("Missing arguments for Token LESS THAN"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re<E.re?1:0):u("LESS THAN is not defined for complex numbers"));case r.Token.GREATER:return null==e.left||null==e.right?u("Missing arguments for Token GREATER THAN"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re>E.re?1:0):u("GREATER THAN is not defined for complex numbers"));case r.Token.LESS_OR_EQUAL:return null==e.left||null==e.right?u("Missing arguments for Token LESS THAN OR EQUAL TO"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re<=E.re?1:0):u("LESS THAN OR EQUAL TO is not defined for complex numbers"));case r.Token.GREATER_OR_EQUAL:return null==e.left||null==e.right?u("Missing arguments for Token GREATER THAN OR EQUAL TO"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re>=E.re?1:0):u("GREATER THAN OR EQUAL TO is not defined for complex numbers"));case r.Token.EQUAL:return null==e.left||null==e.right?u("Missing arguments for Token EQUAL TO"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(Math.abs(i.re-E.re)<1e-10?1:0):(0,l.cpx)(Math.abs(i.re-E.re)<1e-10&&Math.abs(i.im-E.im)<1e-10?1:0));case r.Token.AND:return null==e.left||null==e.right?u("Missing arguments for Token AND"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re&&E.re?1:0):u("AND is not defined for complex numbers"));case r.Token.OR:return null==e.left||null==e.right?u("Missing arguments for Token OR"):(i=c(e.left),E=c(e.right),0===E.im?(0,l.cpx)(i.re||E.re?1:0):u("OR is not defined for complex numbers"));case r.Token.USERVAR:return(0,l.cpx)((0,r.getUserVariable)(e.op.val));case r.Token.FACTORIAL:return null==e.right?u("Missing argument for Token FACTORIAL"):(E=c(e.right),0===E.im?(0,l.cpx)((0,l.factorial)(E.re)):u("FACTORIAL is not defined for complex numbers"));case r.Token.SIGMOID:return null==e.right?u("Missing argument for Token SIGMOID"):(E=c(e.right),0===E.im?(0,l.cpx)((0,l.sigmoid)(E.re)):u("SIGMOID is not defined for complex numbers"));case r.Token.CIRCLE:return u("Token CIRCLE is not allowed");case r.Token.POINT:return u("Token POINT is not allowed");case r.Token.TRUE:return(0,l.cpx)(1);case r.Token.FALSE:return(0,l.cpx)(0);case r.Token.POLAR:return u("Token POLAR is not allowed");case r.Token.CARTESIAN:return u("Token CARTESIAN is not allowed");case r.Token.MOUSEX:return(0,l.cpx)((0,a.getMousePos)().x);case r.Token.MOUSEY:return(0,l.cpx)((0,a.getMousePos)().y);case r.Token.MOUSE:return[(0,a.getMousePos)().x,(0,a.getMousePos)().y];case r.Token.IMAGINARY:return{re:0,im:1};case r.Token.SERIES:return u("Token SERIES not implemented");case r.Token.ITERATOR:return u("Token ITERATOR not implemented");case r.Token.COMPLEX:return u("Token COMPLEX is not allowed");case r.Token.GRADIENT:return u("Token GRADIENT is not allowed");case r.Token.MAGNITUDE:return null==e.right?u("Missing argument for Token MAGNITUDE"):(E=c(e.right),0===E.im?(0,l.cpx)(Math.abs(E.re)):(0,l.cpx)(Math.sqrt(E.re*E.re+E.im*E.im)));case r.Token.ASSIGN:return null==e.left||null==e.right?u("Missing arguments for Token ASSIGN"):e.left.op.tok!==r.Token.ASSIGNABLE?e.left.op.tok===r.Token.USERVAR?((0,r.setUserVariable)(e.left.op.val,c(e.right).re),c(e.right)):u("Left side of ASSIGN must be assignable"):null==(0,r.getExternVariable)(e.left.op.val)?u(`Variable ${e.left.op.val} does not exist`):(E=c(e.right),null===(t=(0,r.getExternVariable)(e.left.op.val))||void 0===t||t.set((null==E?void 0:E.re)?E.re:E),c(e.right));case r.Token.ASSIGNABLE:{if(null==(0,r.getExternVariable)(e.op.val))return u(`Variable ${e.op.val} does not exist`);const t=null===(n=(0,r.getExternVariable)(e.op.val))||void 0===n?void 0:n.get();return(0,l.isIterable)(t)?t:(0,l.cpx)(t)}default:return u(`Unknown token ${e.op.tok}`)}}},533:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPlotsShaderInfo=t.drawPlots=t.drivePlots=t.loadPlots=t.resetPlots=t.setNumInputs=t.setInputAt=void 0;const o=n(607),r=n(85),a=n(195),l=n(103),s=n(849),i=n(320),u=n(984),c=[];let E=0;t.setInputAt=(e,t)=>{e<0||e>E||(c[e]||(c[e]=T(e),(0,i.inputSetColorAt)(e,c[e].color)),c[e].input=t,c[e].inputChanged=!0,(0,o.scheduleRedraw)())},t.setNumInputs=e=>{E=e;for(let e=E;e<c.length;e++)delete c[e];(0,o.scheduleRedraw)()},t.resetPlots=()=>{c.length=0,(0,o.scheduleRedraw)()};const f=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];t.loadPlots=function(e,n){(0,r.resetCanvas)(),(0,i.resetInputs)(),(0,t.setNumInputs)(n.length);for(let e=0;e<n.length;e++)(0,i.addNewInputWithValue)(n[e]);(0,t.drivePlots)(),(0,t.drawPlots)(),(0,i.resetInputs)(),(0,t.setNumInputs)(e.length);for(let t=0;t<e.length;t++)(0,i.addNewInputWithValue)(e[t])};const T=function(e){return{input:"",inputChanged:!1,ast:null,status:a.PlotStatus.PENDING,driver:a.PlotDriver.CANVAS,displayMode:a.PlotDisplayMode.NONE,shaderFunction:"",continuous:!1,color:(t=e,f[(t-1)%f.length]),error:"",iterExpr:""};var t};t.drivePlots=()=>{let e=!1;for(let t=1;t<=E;t++){c[t]||(c[t]=T(t),(0,i.inputSetColorAt)(t,c[t].color));const n=c[t];if(n.inputChanged){e=!0,n.inputChanged=!1;const r=n.status;if(0===n.input.trim().length){n.status=a.PlotStatus.PENDING,n.ast=null,r!==n.status&&(0,i.inputSetStatusAt)(t,n.status),(0,o.scheduleRedraw)();continue}const u=n.ast;n.ast=(0,l.parse)(n.input),console.debug("Parsed AST:",n.ast);const c=n.error,E=(0,l.parserGetError)();E?(n.status=a.PlotStatus.ERROR,n.error=E.desc):(n.status=a.PlotStatus.ACTIVE,n.error=""),JSON.stringify(u)!==JSON.stringify(n.ast)&&(0,o.scheduleRedraw)();const f=(0,l.parserGetDriver)();if(n.driver!==f&&(n.driver=f,(0,i.inputSetDriverAt)(t,f)),n.displayMode=(0,l.parserGetDisplayMode)(),n.driver===a.PlotDriver.WEBGL){n.shaderFunction=(0,s.buildShaderFunction)(n.ast)||"undefined",n.iterExpr=(0,s.shaderFunctionBuilderGetIterExpression)();const e=(0,s.shaderFunctionBuilderGetError)();e&&(n.status=a.PlotStatus.ERROR,n.error=e)}n.continuous=(0,l.parserGetContinuous)(),n.status!==r&&(0,i.inputSetStatusAt)(t,n.status),n.error!==c&&(0,i.inputSetErrorAt)(t,n.error)}}if(e){const e=[];for(let t=1;t<=E;t++)e.push(c[t].input);let t="?";t+="plot="+e.map((e=>encodeURIComponent(e))).join(";"),t+="&scale="+(0,r.getScale)(),window.history.pushState("","",t)}},t.drawPlots=()=>{for(let e=1;e<=E;e++){const t=c[e];if(t&&t.status===a.PlotStatus.ACTIVE){switch(t.driver){case a.PlotDriver.CONSTANT:{const n=(0,u.constantEval)(t.ast);(0,i.inputSetConstEvalAt)(e,n);const o=(0,u.constantEvalGetError)();o&&(t.status=a.PlotStatus.ERROR,t.error=o,(0,i.inputSetStatusAt)(e,t.status),(0,i.inputSetErrorAt)(e,t.error));break}case a.PlotDriver.CANVAS:{(0,r.canvasDrawFunction)(t.ast,t.color);const n=(0,u.constantEvalGetError)();n&&(t.status=a.PlotStatus.ERROR,t.error=n,(0,i.inputSetStatusAt)(e,t.status),(0,i.inputSetErrorAt)(e,t.error));break}case a.PlotDriver.WEBGL:}t.continuous&&(0,o.scheduleRedraw)()}}},t.getPlotsShaderInfo=()=>{const e=[],t=[],n=[],o=[];let r=0;for(let l=1;l<=E;l++){const s=c[l];s&&s.driver===a.PlotDriver.WEBGL&&s.status===a.PlotStatus.ACTIVE&&s.driver===a.PlotDriver.WEBGL&&(e.push(s.shaderFunction),t.push(s.color),n.push(s.displayMode),o.push(s.iterExpr),r++)}return{functions:e,colors:t,displayModes:n,numPlots:r,iterExpr:o}}},195:(e,t)=>{var n,o,r;Object.defineProperty(t,"__esModule",{value:!0}),t.PlotDriver=t.PlotStatus=t.PlotDisplayMode=void 0,(r=t.PlotDisplayMode||(t.PlotDisplayMode={}))[r.NONE=0]="NONE",r[r.CONSTANT_EVAL=1]="CONSTANT_EVAL",r[r.FUNCTION_GRAPH=2]="FUNCTION_GRAPH",r[r.SET=3]="SET",r[r.LEVEL_SET=4]="LEVEL_SET",r[r.VECTOR_FIELD=5]="VECTOR_FIELD",r[r.GRADIENT=6]="GRADIENT",(o=t.PlotStatus||(t.PlotStatus={}))[o.PENDING=0]="PENDING",o[o.ACTIVE=1]="ACTIVE",o[o.ERROR=2]="ERROR",(n=t.PlotDriver||(t.PlotDriver={}))[n.CONSTANT=0]="CONSTANT",n[n.CANVAS=1]="CANVAS",n[n.WEBGL=2]="WEBGL"},99:(e,t)=>{var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.lex=t.clearUserVariables=t.getUserVariable=t.setUserVariable=t.getExternVariable=t.unbindExternVariable=t.bindExternVariable=t.lexerGetError=t.TokenFlag=t.Token=void 0,function(e){e[e.UNDEF=0]="UNDEF",e[e.NONE=1]="NONE",e[e.VAR=2]="VAR",e[e.VAR2=3]="VAR2",e[e.NUM=4]="NUM",e[e.CONST=5]="CONST",e[e.PAREN_OP=6]="PAREN_OP",e[e.PAREN_CL=7]="PAREN_CL",e[e.BRACKET_OP=8]="BRACKET_OP",e[e.BRACKET_CL=9]="BRACKET_CL",e[e.BRACE_OP=10]="BRACE_OP",e[e.BRACE_CL=11]="BRACE_CL",e[e.DELIM=12]="DELIM",e[e.ASSIGN=13]="ASSIGN",e[e.ASSIGNABLE=14]="ASSIGNABLE",e[e.LESS=15]="LESS",e[e.GREATER=16]="GREATER",e[e.LESS_OR_EQUAL=17]="LESS_OR_EQUAL",e[e.GREATER_OR_EQUAL=18]="GREATER_OR_EQUAL",e[e.USERVAR=19]="USERVAR",e[e.ADD=20]="ADD",e[e.SUB=21]="SUB",e[e.MULT=22]="MULT",e[e.DIV=23]="DIV",e[e.POW=24]="POW",e[e.AND=25]="AND",e[e.OR=26]="OR",e[e.NOT_EQUAL=27]="NOT_EQUAL",e[e.EQUAL=28]="EQUAL",e[e.TRUE=29]="TRUE",e[e.FALSE=30]="FALSE",e[e.SQRT=31]="SQRT",e[e.EXP=32]="EXP",e[e.LOG=33]="LOG",e[e.SIN=34]="SIN",e[e.COS=35]="COS",e[e.TAN=36]="TAN",e[e.ASIN=37]="ASIN",e[e.ACOS=38]="ACOS",e[e.ATAN=39]="ATAN",e[e.SINH=40]="SINH",e[e.COSH=41]="COSH",e[e.TANH=42]="TANH",e[e.FLOOR=43]="FLOOR",e[e.MIN=44]="MIN",e[e.MAX=45]="MAX",e[e.ABS=46]="ABS",e[e.MOD=47]="MOD",e[e.RAND=48]="RAND",e[e.PERLIN=49]="PERLIN",e[e.FACTORIAL=50]="FACTORIAL",e[e.SIGMOID=51]="SIGMOID",e[e.LEVEL_SET=52]="LEVEL_SET",e[e.VECTOR_FIELD=53]="VECTOR_FIELD",e[e.CIRCLE=54]="CIRCLE",e[e.POINT=55]="POINT",e[e.TIME=56]="TIME",e[e.MAGNITUDE=57]="MAGNITUDE",e[e.IMAGINARY=58]="IMAGINARY",e[e.POLAR=59]="POLAR",e[e.CARTESIAN=60]="CARTESIAN",e[e.MOUSEX=61]="MOUSEX",e[e.MOUSEY=62]="MOUSEY",e[e.MOUSE=63]="MOUSE",e[e.SERIES=64]="SERIES",e[e.ITERATOR=65]="ITERATOR",e[e.COMPLEX=66]="COMPLEX",e[e.GRADIENT=67]="GRADIENT"}(n=t.Token||(t.Token={})),function(e){e[e.IMPL_MULT_BEFORE=1]="IMPL_MULT_BEFORE",e[e.IMPL_MULT_AFTER=2]="IMPL_MULT_AFTER",e[e.PREFIX=4]="PREFIX",e[e.UNIQUE=16]="UNIQUE",e[e.BEGIN_SCOPE=32]="BEGIN_SCOPE",e[e.END_SCOPE=64]="END_SCOPE",e[e.WEBGL_ONLY=128]="WEBGL_ONLY"}(o=t.TokenFlag||(t.TokenFlag={}));const r={"(":{tok:n.PAREN_OP,flags:o.IMPL_MULT_BEFORE|o.UNIQUE|o.BEGIN_SCOPE},")":{tok:n.PAREN_CL,flags:o.IMPL_MULT_AFTER|o.UNIQUE|o.END_SCOPE},"[":{tok:n.BRACKET_OP,flags:o.IMPL_MULT_BEFORE|o.UNIQUE|o.BEGIN_SCOPE},"]":{tok:n.BRACKET_CL,flags:o.IMPL_MULT_AFTER|o.UNIQUE|o.END_SCOPE},"{":{tok:n.BRACE_OP,flags:o.IMPL_MULT_BEFORE|o.UNIQUE|o.BEGIN_SCOPE},"}":{tok:n.BRACE_CL,flags:o.IMPL_MULT_AFTER|o.UNIQUE|o.END_SCOPE},",":{tok:n.DELIM,flags:o.UNIQUE},"=":{tok:n.ASSIGN,flags:0},x:{tok:n.VAR,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},y:{tok:n.VAR2,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER|o.WEBGL_ONLY},"<":{tok:n.LESS,flags:0},">":{tok:n.GREATER,flags:0},"<=":{tok:n.LESS_OR_EQUAL,flags:o.UNIQUE},">=":{tok:n.GREATER_OR_EQUAL,flags:o.UNIQUE},"!=":{tok:n.NOT_EQUAL,flags:o.UNIQUE},"==":{tok:n.EQUAL,flags:o.UNIQUE},"&&":{tok:n.AND,flags:o.UNIQUE},"||":{tok:n.OR,flags:o.UNIQUE},"+":{tok:n.ADD,flags:o.UNIQUE},"-":{tok:n.SUB,flags:o.UNIQUE},"*":{tok:n.MULT,flags:0},"/":{tok:n.DIV,flags:o.UNIQUE},"^":{tok:n.POW,flags:o.UNIQUE},"**":{tok:n.POW,flags:o.UNIQUE},"%":{tok:n.MOD,flags:0},mod:{tok:n.MOD,flags:0},true:{tok:n.TRUE,flags:0},false:{tok:n.FALSE,flags:0},sqrt:{tok:n.SQRT,flags:o.IMPL_MULT_BEFORE|o.PREFIX},exp:{tok:n.EXP,flags:o.IMPL_MULT_BEFORE|o.PREFIX},log:{tok:n.LOG,flags:o.IMPL_MULT_BEFORE|o.PREFIX},ln:{tok:n.LOG,flags:o.IMPL_MULT_BEFORE|o.PREFIX},sin:{tok:n.SIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},cos:{tok:n.COS,flags:o.IMPL_MULT_BEFORE|o.PREFIX},tan:{tok:n.TAN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},asin:{tok:n.ASIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},acos:{tok:n.ACOS,flags:o.IMPL_MULT_BEFORE|o.PREFIX},atan:{tok:n.ATAN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},arcsin:{tok:n.ASIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},arccos:{tok:n.ACOS,flags:o.IMPL_MULT_BEFORE|o.PREFIX},arctan:{tok:n.ATAN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},sinh:{tok:n.SINH,flags:o.IMPL_MULT_BEFORE|o.PREFIX},cosh:{tok:n.COSH,flags:o.IMPL_MULT_BEFORE|o.PREFIX},tanh:{tok:n.TANH,flags:o.IMPL_MULT_BEFORE|o.PREFIX},floor:{tok:n.FLOOR,flags:o.IMPL_MULT_BEFORE|o.PREFIX},min:{tok:n.MIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},max:{tok:n.MAX,flags:o.IMPL_MULT_BEFORE|o.PREFIX},abs:{tok:n.ABS,flags:o.IMPL_MULT_BEFORE|o.PREFIX},rand:{tok:n.RAND,flags:o.IMPL_MULT_BEFORE|o.PREFIX},random:{tok:n.RAND,flags:o.IMPL_MULT_BEFORE|o.PREFIX},perlin:{tok:n.PERLIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},noise:{tok:n.PERLIN,flags:o.IMPL_MULT_BEFORE|o.PREFIX},fact:{tok:n.FACTORIAL,flags:o.IMPL_MULT_BEFORE|o.PREFIX},factorial:{tok:n.FACTORIAL,flags:o.IMPL_MULT_BEFORE|o.PREFIX},sigmoid:{tok:n.SIGMOID,flags:o.IMPL_MULT_BEFORE|o.PREFIX},Level:{tok:n.LEVEL_SET,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},Niveau:{tok:n.LEVEL_SET,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},VectorField:{tok:n.VECTOR_FIELD,flags:o.IMPL_MULT_BEFORE|o.PREFIX},"|":{tok:n.ABS,flags:o.BEGIN_SCOPE|o.END_SCOPE},Circle:{tok:n.CIRCLE,flags:o.PREFIX|o.WEBGL_ONLY},Point:{tok:n.POINT,flags:o.PREFIX|o.WEBGL_ONLY},Polar:{tok:n.POLAR,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},Pol:{tok:n.POLAR,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},Cartesian:{tok:n.CARTESIAN,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},Cart:{tok:n.CARTESIAN,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},t:{tok:n.TIME,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},mouseX:{tok:n.MOUSEX,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},mouseY:{tok:n.MOUSEY,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},mouse:{tok:n.MOUSE,flags:0},i:{tok:n.IMAGINARY,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},Series:{tok:n.SERIES,flags:o.IMPL_MULT_BEFORE|o.PREFIX|o.WEBGL_ONLY},k:{tok:n.ITERATOR,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},z:{tok:n.COMPLEX,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER},Mag:{tok:n.MAGNITUDE,flags:o.IMPL_MULT_BEFORE|o.PREFIX},Gradient:{tok:n.GRADIENT,flags:o.PREFIX}},a={pi:Math.PI,Pi:Math.PI,e:Math.E};let l=null;t.lexerGetError=()=>l;const s=e=>/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(e),i={};t.bindExternVariable=(e,t,n)=>{i[e]={get:t,set:n}},t.unbindExternVariable=e=>{delete i[e]},t.getExternVariable=e=>i[e];let u={};t.setUserVariable=(e,t)=>{u[e]=t},t.getUserVariable=e=>u[e]||0,t.clearUserVariables=()=>{u={}},t.lex=e=>{l=null;const t=(e=e.replace(/\s/g,"")).split(new RegExp(`(${Object.keys(r).filter((e=>r[e].flags&o.UNIQUE)).map((e=>(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"))(e))).join("|")})`,"g")).filter((e=>""!==e)),u=[];let c=0;return t.forEach((e=>{let t=0;for(let T=e.length;T>t;T--){const g=e.substring(t,T);let h=!1;if(r[g])u.push({tok:r[g].tok,val:0,flags:r[g].flags}),h=!0;else if(a[g])u.push({tok:n.CONST,val:a[g],flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER}),h=!0;else if(i[g])u.push({tok:n.ASSIGNABLE,val:g,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER}),h=!0;else if(isNaN(Number(g))){if(T-1===t){let r="";for(let n=t+1;n<=e.length;n++){const o=e.substring(t,n);if(!s(o))break;r=o}if(""!==r){u.push({tok:n.USERVAR,val:r,flags:o.IMPL_MULT_BEFORE|o.IMPL_MULT_AFTER}),t+=r.length,T=e.length+1;continue}return E=`Unknown token: ´${e.substring(t,e.length)}´`,f=c+t,console.error(`Error at position ${f}: ${E}`),l={desc:E,pos:f},[]}}else u.push({tok:n.NUM,val:parseFloat(g),flags:o.IMPL_MULT_AFTER}),h=!0;h&&(t=T,T=e.length+1)}var E,f;c+=e.length})),u}},103:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.parse=t.parserGetDisplayMode=t.parserGetDriver=t.parserGetContinuous=t.parserGetError=void 0;const o=n(195),r=n(99),a={[r.Token.OR]:0,[r.Token.DELIM]:1,[r.Token.AND]:2,[r.Token.EQUAL]:3,[r.Token.NOT_EQUAL]:3,[r.Token.ASSIGN]:3,[r.Token.LESS]:4,[r.Token.LESS_OR_EQUAL]:4,[r.Token.GREATER]:4,[r.Token.GREATER_OR_EQUAL]:4,[r.Token.ADD]:5,[r.Token.SUB]:5,[r.Token.MULT]:6,[r.Token.DIV]:6,[r.Token.MOD]:6,[r.Token.POW]:7},l=(e,t)=>{console.error(`Error at position ${t}: ${e}`),s={desc:e,pos:t}};let s=null,i=!1,u=o.PlotDriver.CONSTANT,c=o.PlotDisplayMode.NONE;t.parserGetError=()=>s,t.parserGetContinuous=()=>i,t.parserGetDriver=()=>u,t.parserGetDisplayMode=()=>c,t.parse=e=>{s=null,i=!1,u=o.PlotDriver.CONSTANT,c=o.PlotDisplayMode.NONE;let t=(0,r.lex)(e);console.debug("Lexer output:",t);const n=(0,r.lexerGetError)();if(n)return s=JSON.parse(JSON.stringify(n)),null;if(t=E(t),console.debug("Validated ops:",t),null==t)return null;if(t=f(t),console.debug("Expanded ops:",t),null==t)return null;const a=(t.filter((e=>e.tok===r.Token.VAR)).length>0?1:0)+(t.filter((e=>e.tok===r.Token.VAR2)).length>0?1:0);return t.filter((e=>e.flags&r.TokenFlag.WEBGL_ONLY)).length>0?(u=o.PlotDriver.WEBGL,c=o.PlotDisplayMode.SET,t.filter((e=>e.tok===r.Token.LEVEL_SET)).length>0?c=o.PlotDisplayMode.LEVEL_SET:t.filter((e=>e.tok===r.Token.VECTOR_FIELD)).length>0?c=o.PlotDisplayMode.VECTOR_FIELD:t.filter((e=>e.tok===r.Token.GRADIENT)).length>0&&(c=o.PlotDisplayMode.GRADIENT)):0===a?(u=o.PlotDriver.CONSTANT,c=o.PlotDisplayMode.CONSTANT_EVAL):1===a&&(u=o.PlotDriver.CANVAS,c=o.PlotDisplayMode.FUNCTION_GRAPH),i=t.filter((e=>e.tok===r.Token.TIME)).length>0||t.filter((e=>e.tok===r.Token.MOUSEX)).length>0||t.filter((e=>e.tok===r.Token.MOUSEY)).length>0,t=T(t),console.debug("Optimized ops:",t),null==t?null:g(t)};const E=e=>{const t=[];for(let n=0;n<e.length;n++){const o=e[n];if(o.flags&r.TokenFlag.BEGIN_SCOPE&&t.push({tok:o.tok,pos:n}),o.flags&r.TokenFlag.END_SCOPE){const{tok:e,pos:n}=t.pop()||{tok:r.Token.NONE,pos:0};let a=r.Token.NONE;switch(e){case r.Token.PAREN_OP:a=r.Token.PAREN_CL;break;case r.Token.BRACKET_OP:a=r.Token.BRACKET_CL;break;case r.Token.BRACE_OP:a=r.Token.BRACE_CL;break;case r.Token.ABS:a=r.Token.ABS}if(o.tok!==a)return l("Mismatched parentheses",n),null}}if(t.length>0){const{pos:e}=t[0];return l("Unmatched parentheses",e),null}return e},f=e=>{const t=[];for(let n=0;n<e.length;n++){const o=e[n];if(o.tok===r.Token.ABS&&o.flags&r.TokenFlag.BEGIN_SCOPE){const a=t.pop();if(t.push({tok:o.tok,pos:n}),!a)continue;const l=e.splice(a.pos+1,n-a.pos-1);e.splice(a.pos,2),e.splice(a.pos,0,{tok:r.Token.ABS,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.PREFIX},{tok:r.Token.PAREN_OP,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.UNIQUE|r.TokenFlag.BEGIN_SCOPE},...l,{tok:r.Token.PAREN_CL,val:0,flags:r.TokenFlag.IMPL_MULT_AFTER|r.TokenFlag.UNIQUE|r.TokenFlag.END_SCOPE}),n=a.pos+l.length+3,t.pop()}}for(let t=0;t<e.length;t++)e[t].tok===r.Token.MOUSE?(e.splice(t,1,{tok:r.Token.MOUSEX,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE},{tok:r.Token.DELIM,val:0,flags:0},{tok:r.Token.MOUSEY,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE}),t+=2):e[t].tok===r.Token.COMPLEX&&(e.splice(t,1,{tok:r.Token.PAREN_OP,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.BEGIN_SCOPE},{tok:r.Token.VAR,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.IMPL_MULT_AFTER},{tok:r.Token.ADD,val:0,flags:0},{tok:r.Token.VAR2,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.IMPL_MULT_AFTER|r.TokenFlag.WEBGL_ONLY},{tok:r.Token.IMAGINARY,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.IMPL_MULT_AFTER},{tok:r.Token.PAREN_CL,val:0,flags:r.TokenFlag.IMPL_MULT_AFTER|r.TokenFlag.END_SCOPE}),t+=5);for(let t=1;t<e.length;t++)e[t-1].flags&r.TokenFlag.IMPL_MULT_AFTER&&e[t].flags&r.TokenFlag.IMPL_MULT_BEFORE&&e.splice(t,0,{tok:r.Token.MULT,val:0,flags:0});for(let t=8;t>0;t--)for(let n=0;n<e.length;n++)if(a[e[n].tok]===t){let o=0,l=e.length,s=0;for(let l=n;l>=0;l--)if(e[l].flags&r.TokenFlag.BEGIN_SCOPE?s++:e[l].flags&r.TokenFlag.END_SCOPE&&s--,a[e[l].tok]<t&&0===s||s>0){o=l+1;break}s=0;for(let o=n;o<e.length;o++)if(e[o].flags&r.TokenFlag.BEGIN_SCOPE?s++:e[o].flags&r.TokenFlag.END_SCOPE&&s--,a[e[o].tok]<t&&0===s||s<0){l=o;break}e.splice(l,0,{tok:r.Token.PAREN_CL,val:0,flags:r.TokenFlag.IMPL_MULT_AFTER|r.TokenFlag.UNIQUE|r.TokenFlag.END_SCOPE}),e.splice(o,0,{tok:r.Token.PAREN_OP,val:0,flags:r.TokenFlag.IMPL_MULT_BEFORE|r.TokenFlag.UNIQUE|r.TokenFlag.BEGIN_SCOPE}),n++}for(let t=0;t<e.length;t++)e[t].tok===r.Token.SUB&&(0===t||e[t-1].flags&r.TokenFlag.BEGIN_SCOPE)&&e.splice(t,0,{tok:r.Token.NUM,val:0,flags:r.TokenFlag.IMPL_MULT_AFTER});return e},T=e=>{let t=0;for(let n=0;n<e.length;n++)if(e[n].tok===r.Token.SUB)t++;else{if(t>1)if(t%2==1)for(let o=0;o<t-1;o++)e.splice(n-t,1);else{for(let o=0;o<t;o++)e.splice(n-t,1);e.splice(n-t,0,{tok:r.Token.ADD,val:0,flags:0})}t=0}for(let t=1;t<e.length;t++)e[t].flags&r.TokenFlag.END_SCOPE&&e[t-1].flags&r.TokenFlag.BEGIN_SCOPE&&e.splice(t-1,2);return e},g=e=>{const t={op:{tok:r.Token.NONE,val:0,flags:0},left:null,right:null};let n=t;const o=[];let a=0;for(let t=0;t<e.length;t++){const s=e[t];if(s.flags&r.TokenFlag.BEGIN_SCOPE)a++;else if(s.flags&r.TokenFlag.END_SCOPE){if(a<=0)return l("Unexpected end of scope",t),null;a--,n=o.pop();continue}if(null==n.op||n.op.tok===r.Token.NONE||n.op.flags&r.TokenFlag.BEGIN_SCOPE)n.op=s,n.op.flags&r.TokenFlag.BEGIN_SCOPE&&o.push(n);else if(null==n.left){if(n.op.flags&r.TokenFlag.PREFIX){n.left={op:{tok:r.Token.UNDEF,val:0,flags:0},left:null,right:null},n.right={op:s,left:null,right:null},n.right.op.flags&r.TokenFlag.BEGIN_SCOPE&&(o.push(n),n=n.right);continue}const e=JSON.parse(JSON.stringify(n));n.left=e,n.op=s}else if(null==n.right||n.right.op.flags&r.TokenFlag.BEGIN_SCOPE)n.right={op:s,left:null,right:null},n.right.op.flags&r.TokenFlag.BEGIN_SCOPE&&(o.push(n),n=n.right);else if(n.right.op.flags&r.TokenFlag.PREFIX&&null==n.right.right)o.push(n),n=n.right,n.right={op:s,left:null,right:null};else{const e=JSON.parse(JSON.stringify(n));n.left=e,n.right=null,n.op=s}}return 0!==a?(l("Unexpected end of expression",e.length),null):t}},682:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function l(e){try{i(o.next(e))}catch(e){a(e)}}function s(e){try{i(o.throw(e))}catch(e){a(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,s)}i((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.shadersDraw=t.scheduleReloadShaders=t.shaderCoreUpdate=t.initShaderCore=t.shadersClearAll=void 0;const r=n(607),a=n(85),l=n(533),s=n(195),i=n(633),u=n(750);let c=null,E=null,f=!1,T=!1,g=!1;const h={},M=document.getElementById("shader-canvas"),d=M.getContext("webgl2");function k(e){return o(this,void 0,void 0,(function*(){if(!h[e]){const t=yield fetch(e),n=yield t.text();return h[e]=n,n}return Promise.resolve(h[e])}))}function p(){return o(this,void 0,void 0,(function*(){f=!0,yield Promise.all([k("assets/shaders/plot.vert"),k("assets/shaders/plot.frag")]).then((e=>{e[1]=function(e){const t=(0,l.getPlotsShaderInfo)();return 0===t.numPlots&&(t.functions=[],t.colors=["#000000"],t.displayModes=[s.PlotDisplayMode.NONE],t.iterExpr=[]),t.functions.push("0.0"),t.iterExpr.push("vec2(0.0,0.0)"),e.replace(/USER_NUM_FUNC_INJ/g,`${t.numPlots+1}`).replace(/USER_FUNC_INJ/g,`float[](${t.functions.map((e=>`(${e})`)).join(",")})`).replace(/USER_COL_INJ/g,`vec3[](${t.colors.map((e=>{return`vec3(${t=e,`${parseInt(t.substring(1,3),16)/255}, ${parseInt(t.substring(3,5),16)/255}, ${parseInt(t.substring(5,7),16)/255}`})`;var t})).join(",")})`).replace(/USER_DISP_INJ/g,`int[](${t.displayModes.map((e=>`${e}`)).join(",")})`).replace(/USER_ITER_EXPR_INJ/g,`vec2[](${t.iterExpr.map((e=>`(${e.length>0?e:"vec2(0.0,0.0)"})`)).join(",")})`)}(e[1]);const t=function(e,t){const n=L(d.VERTEX_SHADER,e),o=L(d.FRAGMENT_SHADER,t);if(!n||!o)return null;const r=d.createProgram();return r?(d.attachShader(r,n),d.attachShader(r,o),d.linkProgram(r),d.getProgramParameter(r,d.LINK_STATUS)?r:(console.error("Failed to link program: "+d.getProgramInfoLog(r)),null)):(console.error("Failed to create program"),null)}(e[0],e[1]);t?(c={program:t,attribLocations:{vertexPosition:d.getAttribLocation(t,"aVertexPosition")},uniformLocations:{projectionMatrix:d.getUniformLocation(t,"uProjectionMatrix"),modelViewMatrix:d.getUniformLocation(t,"uModelViewMatrix"),u_resolution:d.getUniformLocation(t,"u_resolution"),u_mouse:d.getUniformLocation(t,"u_mouse"),u_time:d.getUniformLocation(t,"u_time"),u_deviation:d.getUniformLocation(t,"u_deviation"),u_domain_x:d.getUniformLocation(t,"u_domain_x"),u_domain_y:d.getUniformLocation(t,"u_domain_y"),u_display_mode:d.getUniformLocation(t,"u_display_mode")}},E=function(){const e=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,e);return d.bufferData(d.ARRAY_BUFFER,new Float32Array([1,1,-1,1,1,-1,-1,-1]),d.STATIC_DRAW),e}(),T=!0,f=!1):console.error("Failed to load shaders")}))}))}function L(e,t){const n=d.createShader(e);return n?(d.shaderSource(n,t),d.compileShader(n),d.getShaderParameter(n,d.COMPILE_STATUS)?n:(console.error("Failed to compile shader: "+d.getShaderInfoLog(n)),d.getShaderInfoLog(n),d.deleteShader(n),null)):(console.error("Failed to create shader"),null)}function m(){d.clearColor(0,0,0,1),d.clearDepth(1),d.enable(d.DEPTH_TEST),d.depthFunc(d.LEQUAL),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT);const e=45*Math.PI/180,t=d.canvas.clientWidth/d.canvas.clientHeight,n=i.create();i.perspective(n,e,t,.1,100);const o=i.create();i.translate(o,o,[0,0,-1]);const l=d.FLOAT;d.bindBuffer(d.ARRAY_BUFFER,E),d.vertexAttribPointer(c.attribLocations.vertexPosition,2,l,!1,0,0),d.enableVertexAttribArray(c.attribLocations.vertexPosition),d.useProgram(c.program);const s=(0,u.getMousePos)(),f=(0,a.getDomain)();d.uniformMatrix4fv(c.uniformLocations.projectionMatrix,!1,n),d.uniformMatrix4fv(c.uniformLocations.modelViewMatrix,!1,o),d.uniform2f(c.uniformLocations.u_resolution,d.canvas.width,d.canvas.height),d.uniform2f(c.uniformLocations.u_mouse,s.x,s.y),d.uniform2f(c.uniformLocations.u_domain_x,f.minX,f.maxX),d.uniform2f(c.uniformLocations.u_domain_y,f.minY,f.maxY),d.uniform1f(c.uniformLocations.u_time,(0,r.getGlobalTime)()),d.uniform1f(c.uniformLocations.u_deviation,.004),d.uniform1i(c.uniformLocations.u_display_mode,0),d.drawArrays(d.TRIANGLE_STRIP,0,4)}t.shadersClearAll=function(){(0,t.scheduleReloadShaders)()},t.initShaderCore=function(){M&&d||console.error("Failed to initialize WebGL context.")},t.shaderCoreUpdate=function(){T||f||g||(p(),g&&console.error("Failed to load shaders"))},t.scheduleReloadShaders=function(){g=!1,T=!1,f=!1},t.shadersDraw=function(){T=!1,!T||g?p().then((()=>{if(!T)return console.error("Failed to initialize shaders"),void d.clearColor(0,0,0,1);m()})):m()}},849:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.buildShaderFunction=t.shaderFunctionBuilderGetIterExpression=t.shaderFunctionBuilderGetError=void 0;const o=n(607),r=n(99),a=n(283);let l=null;t.shaderFunctionBuilderGetError=()=>l;let s="";t.shaderFunctionBuilderGetIterExpression=()=>s,t.buildShaderFunction=e=>{if(!e)return null;l=null,s="";const t=f(e);return console.debug("Shader function: "+t.val),t.val};const i=function(e){return console.error("Error during constant evaluation: "+e),l=e,{val:null,cpx:!1}},u=function(e){return-1===e.toString().indexOf(".")?e.toString()+".0":e.toString()},c=e=>({val:e,cpx:!1}),E=e=>({val:e,cpx:!0}),f=function(e){var t;let n,l;switch(e.op.tok){case r.Token.UNDEF:return i("Token UNDEFINED is not allowed");case r.Token.NONE:return c("0");case r.Token.PAREN_OP:return i("Token OPEN PARENTHESIS is not allowed");case r.Token.PAREN_CL:return i("Token CLOSE PARENTHESIS is not allowed");case r.Token.BRACKET_OP:return i("Token OPEN BRACKET is not allowed");case r.Token.BRACKET_CL:return i("Token CLOSE BRACKET is not allowed");case r.Token.BRACE_OP:return i("Token OPEN BRACE is not allowed");case r.Token.BRACE_CL:return i("Token CLOSE BRACE is not allowed");case r.Token.NUM:return"number"!=typeof e.op.val?i("Token NUMBER must be a number"):c(u(e.op.val));case r.Token.CONST:return"number"!=typeof e.op.val?i("Token CONSTANT must be a number"):c(u(e.op.val));case r.Token.VAR:return c("x");case r.Token.VAR2:return c("y");case r.Token.TIME:return(0,o.scheduleRedraw)(),c("t");case r.Token.ADD:return null==e.left||null==e.right?i("Missing arguments for Token ADDITION"):(n=f(e.left),l=f(e.right),n.cpx||l.cpx?E(`add(${n.val},${l.val})`):c(`(${n.val}+${l.val})`));case r.Token.SUB:return null==e.left||null==e.right?i("Missing arguments for Token SUBTRACTION"):(n=f(e.left),l=f(e.right),n.cpx||l.cpx?E(`sub(${n.val},${l.val})`):c(`(${n.val}-${l.val})`));case r.Token.MULT:return null==e.left||null==e.right?i("Missing arguments for Token MULTIPLICATION"):(n=f(e.left),l=f(e.right),n.cpx||l.cpx?E(`mul(${n.val},${l.val})`):c(`(${n.val}*${l.val})`));case r.Token.DIV:return null==e.left||null==e.right?i("Missing arguments for Token DIVISION"):(n=f(e.left),l=f(e.right),n.cpx||l.cpx?E(`div(${n.val},${l.val})`):c(`(${n.val}/${l.val})`));case r.Token.POW:return null==e.left||null==e.right?i("Missing arguments for Token POWER"):(n=f(e.left),l=f(e.right),n.cpx||l.cpx?l.cpx?i("Power cannot be complex"):E(`_pow(${n.val},${l.val})`):c(`_pow(${n.val},${l.val})`));case r.Token.SQRT:return null==e.right?i("Missing argument for Token SQUARE ROOT"):(l=f(e.right),l.cpx?i("Square root cannot be complex"):c(`sqrt(${l.val})`));case r.Token.LOG:return null==e.right?i("Missing argument for Token LOGARITHM"):(l=f(e.right),l.cpx?i("Logarithm cannot be complex"):c(`log(${l.val})`));case r.Token.EXP:return null==e.right?i("Missing argument for Token EXPOENTIAL"):(l=f(e.right),l.cpx?i("Exponential cannot be complex"):c(`exp(${l.val})`));case r.Token.SIN:return null==e.right?i("Missing argument for Token SINE"):(l=f(e.right),l.cpx?i("Sine cannot be complex"):c(`sin(${l.val})`));case r.Token.COS:return null==e.right?i("Missing argument for Token COSINE"):(l=f(e.right),l.cpx?i("Cosine cannot be complex"):c(`cos(${l.val})`));case r.Token.TAN:return null==e.right?i("Missing argument for Token TANGENT"):(l=f(e.right),l.cpx?i("Tangent cannot be complex"):c(`tan(${l.val})`));case r.Token.ASIN:return null==e.right?i("Missing argument for Token ARC SINE"):(l=f(e.right),l.cpx?i("Arc sine cannot be complex"):c(`asin(${l.val})`));case r.Token.ACOS:return null==e.right?i("Missing argument for Token ARC COSINE"):(l=f(e.right),l.cpx?i("Arc cosine cannot be complex"):c(`acos(${l.val})`));case r.Token.ATAN:return null==e.right?i("Missing argument for Token ARC TANGENT"):(l=f(e.right),l.cpx?i("Arc tangent cannot be complex"):c(`atan(${l.val})`));case r.Token.SINH:return null==e.right?i("Missing argument for Token HYPERBOLIC SINE"):(l=f(e.right),l.cpx?i("Sine hyperbolicus cannot be complex"):c(`sinh(${l.val})`));case r.Token.COSH:return null==e.right?i("Missing argument for Token HYPERBOLIC COSINE"):(l=f(e.right),l.cpx?i("Cosine hyperbolicus cannot be complex"):c(`cosh(${l.val})`));case r.Token.TANH:return null==e.right?i("Missing argument for Token HYPERBOLIC TANGENT"):(l=f(e.right),l.cpx?i("Hyperbolic tangent cannot be complex"):c(`tanh(${l.val})`));case r.Token.FLOOR:return null==e.right?i("Missing argument for Token FLOOR"):(l=f(e.right),l.cpx?i("Floor cannot be complex"):c(`floor(${l.val})`));case r.Token.MIN:return null==e.right?i("Missing argument for Token MIN"):(0,a.isIterable)(f(e.right).val)?c(`min(${f(e.right).val})`):i("Malformed argument for Token MIN");case r.Token.MAX:return null==e.right?i("Missing argument for Token MAX"):(0,a.isIterable)(f(e.right).val)?c(`max(${f(e.right).val})`):i("Malformed argument for Token MAX");case r.Token.DELIM:return null==e.left||null==e.right?i("Missing arguments for Token DELIMITER"):c(`${f(e.left).val},${f(e.right).val}`);case r.Token.ABS:return null==e.right?i("Missing argument for Token ABSOLUTE"):(l=f(e.right),l.cpx?c(`mag(${l.val})`):c(`abs(${l.val})`));case r.Token.RAND:return null==e.right?i("Missing argument for Token RANDOM"):c(`random(${f(e.right).val})`);case r.Token.PERLIN:return null==e.right?i("Missing arguments for Token PERLIN"):(0,a.isIterable)(f(e.right).val)?c(`noise(vec2(${f(e.right).val}))`):i("Malformed argument for Token PERLIN");case r.Token.MOD:return null==e.left||null==e.right?i("Missing arguments for Token MODULUS"):c(`mod(${f(e.left).val},${f(e.right).val})`);case r.Token.LEVEL_SET:return null==e.right?i("Missing argument for Token LEVEL SET"):e.right.op.tok===r.Token.DELIM?null==e.right.left||null==e.right.right?i("Missing arguments for Token LEVEL SET"):c(`${f(e.right.left).val}+((level=${f(e.right.right).val})>0.0?0.0:0.0)`):f(e.right);case r.Token.VECTOR_FIELD:return i("Token VECTOR FIELD is not allowed");case r.Token.LESS:return null==e.left||null==e.right?i("Missing arguments for Token LESS THAN"):c(`btof(${f(e.left).val}<${f(e.right).val})`);case r.Token.GREATER:return null==e.left||null==e.right?i("Missing arguments for Token GREATER THAN"):c(`btof(${f(e.left).val}>${f(e.right).val})`);case r.Token.LESS_OR_EQUAL:return null==e.left||null==e.right?i("Missing arguments for Token LESS THAN OR EQUAL TO"):c(`btof(${f(e.left).val}<=${f(e.right).val})`);case r.Token.GREATER_OR_EQUAL:return null==e.left||null==e.right?i("Missing arguments for Token GREATER THAN OR EQUAL TO"):c(`btof(${f(e.left).val}>=${f(e.right).val})`);case r.Token.EQUAL:return null==e.left||null==e.right?i("Missing arguments for Token EQUAL TO"):c(`btof(${f(e.left).val}==${f(e.right).val})`);case r.Token.AND:return null==e.left||null==e.right?i("Missing arguments for Token AND"):c(`btof(ftob(${f(e.left).val})&&ftob(${f(e.right).val}))`);case r.Token.OR:return null==e.left||null==e.right?i("Missing arguments for Token OR"):c(`btof(ftob(${f(e.left).val})||ftob(${f(e.right).val}))`);case r.Token.USERVAR:return c(`btof(${(0,r.getUserVariable)(e.op.val)})`);case r.Token.FACTORIAL:return null==e.right?i("Missing argument for Token FACTORIAL"):c(`factorial(${f(e.right).val})`);case r.Token.SIGMOID:return null==e.right?i("Missing argument for Token SIGMOID"):c(`(1.0/(1.0+exp(-(${f(e.right).val}))))`);case r.Token.CIRCLE:return null==e.right?i("Missing argument for Token CIRCLE"):c(`circle(x,y,d,${f(e.right).val})`);case r.Token.POINT:return null==e.right?i("Missing argument for Token POINT"):c(`point(x,y,d,${f(e.right).val})`);case r.Token.TRUE:return c("btof(true)");case r.Token.FALSE:return c("btof(false)");case r.Token.POLAR:return null==e.right?i("Missing argument for Token POLAR"):c(`(POLAR+${f(e.right).val})`);case r.Token.CARTESIAN:return null==e.right?i("Missing argument for Token CARTESIAN"):c(`(CARTESIAN+${f(e.right).val})`);case r.Token.MOUSEX:return c("mx");case r.Token.MOUSEY:return c("my");case r.Token.MOUSE:return i("Token MOUSE is not allowed");case r.Token.IMAGINARY:return E("vec2(0.0,1.0)");case r.Token.SERIES:return null==e.right||null==e.right.left||null==e.right.right?i("Missing argument for Token SERIES"):(s=f(e.right.right).val||"",c(`series(i,x,y,t,${f(e.right.left).val})`));case r.Token.ITERATOR:return c("k");case r.Token.COMPLEX:return i("Token COMPLEX is not allowed");case r.Token.MAGNITUDE:return null==e.right?i("Missing argument for Token MAGNITUDE"):c(`mag(${f(e.right).val})`);case r.Token.GRADIENT:return null==e.right?i("Missing argument for Token GRADIENT"):f(e.right);case r.Token.ASSIGN:return null==e.left||null==e.right?i("Missing arguments for Token ASSIGN"):e.left.op.tok!==r.Token.ASSIGNABLE?e.left.op.tok===r.Token.USERVAR?((0,r.setUserVariable)(e.left.op.val,parseFloat(f(e.right).val)),f(e.right)):c(`btof(abs(${f(e.left).val}-${f(e.right).val})<d)`):null==(0,r.getExternVariable)(e.left.op.val)?i(`Variable ${e.left.op.val} does not exist`):(null===(t=(0,r.getExternVariable)(e.left.op.val))||void 0===t||t.set(parseFloat(f(e.right).val)),f(e.right));default:return i(`Unknown token ${e.op.val}`)}}},320:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getLeftPanelWidth=t.inputSetDriverAt=t.inputSetStatusAt=t.inputSetConstEvalAt=t.inputSetErrorAt=t.inputSetColorAt=t.resetInputs=t.addNewInputWithValue=t.addNewInput=t.initLeftPanel=void 0;const o=n(607),r=n(533),a=n(195),l=n(283),s=n(750),i=document.querySelector(".inputs"),u=document.querySelector(".resize-left-panel"),c=document.getElementById("left-panel");let E=0,f=0;t.initLeftPanel=function(){(0,s.onMouseDrag)(u,(e=>{const t=Math.max(250,Math.min(.95*window.innerWidth,e.x));document.documentElement.style.setProperty("--left-panel-width",`${t}px`),(0,o.scheduleRedraw)()})),(0,t.addNewInput)()},t.addNewInput=function(){const e=(0,l.stringToHTML)('\n\t<div class="input">\n\t<div class="status"><div class="indicator"></div></div>\n\t<input type="text" spellcheck="false" autocorrect="off" autocomplete="off" autocapitalize="off" autofocus>\n\t<div class="delete">×</div>\n\t<div class="const-eval"></div>\n\t</div>').firstChild,n=e.querySelector("input"),a=e.querySelector(".delete"),s=e.querySelector(".indicator");null==n||n.addEventListener("keydown",(function(e){if("Enter"===e.key){if(e.preventDefault(),f>E){const e=i.querySelector(`.input[data-input-idx="${++E}"]`);return g(e),void setTimeout((function(){var t;null===(t=e.querySelector("input"))||void 0===t||t.focus()}),0)}(0,t.addNewInput)()}})),n.addEventListener("click",(function(t){g(e),E=parseInt(e.getAttribute("data-input-idx")||"0"),null==n||n.focus()})),null==n||n.addEventListener("focus",(function(t){g(e),E=parseInt(e.getAttribute("data-input-idx")||"0")})),null==n||n.addEventListener("input",(function(t){E=parseInt(e.getAttribute("data-input-idx")||"0"),s.classList.contains("disabled")?(0,r.setInputAt)(E,""):(0,r.setInputAt)(E,n.value)})),null==a||a.addEventListener("click",(function(t){if(1===f){e.classList.add("illegal");const t=e.querySelector("input");t&&(t.value="");const n=e.querySelector(".indicator");null==n||n.classList.remove("pending","active","error","disabled");const a=e.querySelector(".const-eval");return null==a||a.classList.remove("visible"),setTimeout((()=>e.classList.remove("illegal")),200),(0,o.scheduleRedraw)(),void(0,r.resetPlots)()}e.classList.add("deleted"),setTimeout((function(){e.remove();const t=parseInt(e.getAttribute("data-input-idx")||"0");f--,(0,r.setNumInputs)(f);const o=i.querySelectorAll(".input");for(let e=0;e<o.length;e++){o[e].setAttribute("data-input-idx",(e+1).toString());const t=o[e].querySelector(".indicator");(null==t?void 0:t.classList.contains("disabled"))?(0,r.setInputAt)(e+1,""):(0,r.setInputAt)(e+1,n.value)}if(f>0&&(t<=E||1===t)){const e=i.querySelector(`.input[data-input-idx="${E-1}"]`);g(e),setTimeout((function(){var t;null===(t=e.querySelector("input"))||void 0===t||t.focus()}),0)}}),120)})),null==s||s.addEventListener("click",(function(t){s.classList.toggle("disabled"),E=parseInt(e.getAttribute("data-input-idx")||"0"),s.classList.contains("disabled")?(0,r.setInputAt)(E,""):(0,r.setInputAt)(E,n.value)})),e.setAttribute("data-input-idx",(++E).toString()),e.classList.add("created"),setTimeout((function(){e.classList.remove("created")}),120),f++,(0,r.setNumInputs)(f),g(e),setTimeout((function(){null==n||n.focus()}),0),i.appendChild(e)},t.addNewInputWithValue=function(e){(0,t.addNewInput)(),(0,r.setInputAt)(E,e);const n=i.querySelector(`.input[data-input-idx="${E}"] input`);n&&(n.value=e)},t.resetInputs=function(){const e=i.querySelectorAll(".input");for(let t=0;t<e.length;t++)e[t].remove();f=0,(0,r.setNumInputs)(f),E=0,(0,r.resetPlots)()};const T=function(e){return i.querySelector(`.input[data-input-idx="${e}"]`)};t.inputSetColorAt=function(e,t){var n;null===(n=T(e))||void 0===n||n.setAttribute("data-color",t)},t.inputSetErrorAt=function(e,t){const n=T(e);if(!n)return;const o=n.querySelector(".indicator");o&&o.setAttribute("data-error",t)},t.inputSetConstEvalAt=function(e,t){const n=T(e);if(!n)return;const o=n.querySelector(".const-eval");o&&((0,l.isIterable)(t)?o.innerText=`= (${t.toString()})`:o.innerText="= "+(0,l.complexToString)(t),o.classList.add("visible"))},t.inputSetStatusAt=function(e,t){const n=T(e);if(!n)return;const o=n.querySelector(".indicator");if(!o)return;o.classList.remove("pending","active","error");const r=n.querySelector(".const-eval");if(r)switch(t){case a.PlotStatus.PENDING:o.classList.add("pending"),o.innerHTML="",r.classList.remove("visible");break;case a.PlotStatus.ACTIVE:o.classList.add("active"),o.style.backgroundColor=n.getAttribute("data-color")||"#000",o.innerHTML="";break;case a.PlotStatus.ERROR:o.classList.add("error"),o.innerHTML="!",r.classList.remove("visible")}},t.inputSetDriverAt=function(e,t){const n=T(e);if(!n)return;const o=n.querySelector(".const-eval");o&&t!==a.PlotDriver.CONSTANT&&o.classList.remove("visible")};const g=function(e){i.querySelectorAll(".input").forEach((e=>{e.classList.remove("active")})),e.classList.add("active")};t.getLeftPanelWidth=function(){return c.offsetWidth}},139:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initMenuBar=void 0;const o=n(533),r=n(283),a=document.getElementById("menu-bar");t.initMenuBar=function(){Array.from(a.querySelectorAll("button")).forEach((e=>{const t=e.dataset.icon||"",n=e.dataset.href||"",o=e.dataset.filter||"";if(t&&n){const a='<div class="button-icon"></div>',l=(0,r.stringToHTML)(a).firstChild;l.style.backgroundImage=`url('${t}')`,l.style.filter=o,e.appendChild(l),e.addEventListener("click",(()=>{window.open(n,"_blank")}))}}));const e=document.querySelector(".demo-button"),t=document.querySelector(".examples-list");let n,l=0;fetch("assets/demo/demo.json").then((e=>e.json())).then((e=>{var r;n=e,l=null==e?void 0:e.numPlots;for(let a=0;a<l;a++){const l=document.createElement("div");l.innerHTML=null===(r=null==e?void 0:e.plots[a])||void 0===r?void 0:r.name,l.classList.add("example-list-item"),l.addEventListener("click",(()=>{var e,t;(0,o.loadPlots)((null===(e=null==n?void 0:n.plots[a])||void 0===e?void 0:e.inputs)||"",(null===(t=null==n?void 0:n.plots[a])||void 0===t?void 0:t.defaults)||"")})),t.appendChild(l)}})),e.addEventListener("click",(()=>{t.classList.toggle("hidden")})),document.querySelector(".menu-bar-title h1").onclick=()=>window.location.replace(window.location.origin)}},750:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initUserInteract=t.onMouseDrag=t.getMousePos=void 0;const o=n(283);let r,a=!1,l=!1;const s=new o.Vector(0,0),i=new Map;t.getMousePos=function(){return s},t.onMouseDrag=function(e,t){i.set(e,t)},t.initUserInteract=function(){document.addEventListener("mousedown",(function(e){l=!0})),document.addEventListener("mousemove",(function(e){if(l)if(s.set(e.clientX,e.clientY),a)r(s);else for(const[t,n]of i)if(null==t?void 0:t.contains(e.target))return n(s),a=!0,void(r=n)})),document.addEventListener("mouseup",(function(e){a=!1,l=!1}))}},283:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.map=t.sigmoid=t.factorial=t.perlin2=t.isIterable=t.cpx=t.complexToString=t.Vector=t.stringToHTML=void 0,t.stringToHTML=function(e){return(new DOMParser).parseFromString(e,"text/html").body},t.Vector=class{constructor(e,t){this.x=e,this.y=t}set(e,t){this.x=e,this.y=t}},t.complexToString=function(e){const t=Math.round(1e6*e.re)/1e6,n=Math.round(1e6*e.im)/1e6;return 0===n?t.toString():t+" + "+n+"i"},t.cpx=e=>({re:e,im:0}),t.isIterable=e=>null!=e&&"function"==typeof e[Symbol.iterator];const n=new Array(512),o=new Array(512),r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class a{constructor(e,t,n){this.x=e,this.y=t,this.z=n}}const l=[new a(1,1,0),new a(-1,1,0),new a(1,-1,0),new a(-1,-1,0),new a(1,0,1),new a(-1,0,1),new a(1,0,-1),new a(-1,0,-1),new a(0,1,1),new a(0,-1,1),new a(0,1,-1),new a(0,-1,-1)];function s(e){return e*e*e*(e*(6*e-15)+10)}function i(e,t,n){return(1-n)*e+n*t}!function(e){e>0&&e<1&&(e*=65536),(e=Math.floor(e))<256&&(e|=e<<8);for(let t=0;t<256;t++){let a;a=1&t?r[t]^255&e:r[t]^e>>8&255,n[t]=n[t+256]=a,o[t]=o[t+256]=l[a%12]}}(12345),t.perlin2=function(e,t){let r=Math.floor(e),a=Math.floor(t);e-=r,t-=a,r&=255,a&=255;const l=o[r+n[a]].dot2(e,t),u=o[r+n[a+1]].dot2(e,t-1),c=o[r+1+n[a]].dot2(e-1,t),E=o[r+1+n[a+1]].dot2(e-1,t-1),f=s(e);return i(i(l,c,f),i(u,E,f),s(t))},t.factorial=function(e){const t=Math.floor(e),n=e-t;let o=function(e){return(((((.07288448978215456*e-.31390051543712616)*e+.6538907084614038)*e-.810425715520978)*e+.9737655441276729)*e-.5761851668648887)*e+.9999830044034752}(n);if(e<0)for(let e=0;e<-t;e++)o/=n-e;else for(let e=1;e<t+1;e++)o*=n+e;return e>0?o:1/0},t.sigmoid=function(e){return 1/(1+Math.exp(-e))},t.map=function(e,t,n,o,r){return(e-t)/(n-t)*(r-o)+o}},607:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFPSSmoothed=t.getGlobalTime=t.scheduleRedraw=void 0;const o=n(320),r=n(139),a=n(85),l=n(750),s=n(533),i=n(682);let u=!0,c=0,E=0,f=0;const T=Array(1).fill(60);t.scheduleRedraw=function(){u=!0},t.getGlobalTime=()=>c,t.getFPSSmoothed=()=>T.reduce(((e,t)=>e+t))/T.length,window.onload=function(){(0,l.initUserInteract)(),(0,r.initMenuBar)(),(0,o.initLeftPanel)(),(0,a.initCanvas)(),(0,i.initShaderCore)(),g()};const g=function(){u&&(u=!1,(0,a.canvasDraw)(),(0,i.shadersDraw)(),(0,s.drawPlots)()),(0,a.driveCanvas)(),(0,s.drivePlots)(),(0,i.shaderCoreUpdate)(),c+=.01;const e=Date.now();E=e-f,f=e,T.push(1e3/E),T.length>100&&T.shift(),requestAnimationFrame(g)}},633:(e,t,n)=>{n.r(t),n.d(t,{add:()=>j,adjoint:()=>T,clone:()=>l,copy:()=>s,create:()=>a,decompose:()=>F,determinant:()=>g,equals:()=>ee,exactEquals:()=>Z,frob:()=>Y,fromQuat:()=>D,fromQuat2:()=>_,fromRotation:()=>A,fromRotationTranslation:()=>N,fromRotationTranslationScale:()=>b,fromRotationTranslationScaleOrigin:()=>x,fromScaling:()=>I,fromTranslation:()=>R,fromValues:()=>i,fromXRotation:()=>S,fromYRotation:()=>O,fromZRotation:()=>P,frustum:()=>B,getRotation:()=>C,getScaling:()=>U,getTranslation:()=>v,identity:()=>c,invert:()=>f,lookAt:()=>H,mul:()=>te,multiply:()=>h,multiplyScalar:()=>z,multiplyScalarAndAdd:()=>J,ortho:()=>X,orthoNO:()=>$,orthoZO:()=>Q,perspective:()=>G,perspectiveFromFieldOfView:()=>V,perspectiveNO:()=>y,perspectiveZO:()=>w,rotate:()=>k,rotateX:()=>p,rotateY:()=>L,rotateZ:()=>m,scale:()=>d,set:()=>u,str:()=>W,sub:()=>ne,subtract:()=>K,targetTo:()=>q,translate:()=>M,transpose:()=>E});var o=1e-6,r="undefined"!=typeof Float32Array?Float32Array:Array;function a(){const e=new r(16);return r!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function l(e){const t=new r(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function s(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function i(e,t,n,o,a,l,s,i,u,c,E,f,T,g,h,M){const d=new r(16);return d[0]=e,d[1]=t,d[2]=n,d[3]=o,d[4]=a,d[5]=l,d[6]=s,d[7]=i,d[8]=u,d[9]=c,d[10]=E,d[11]=f,d[12]=T,d[13]=g,d[14]=h,d[15]=M,d}function u(e,t,n,o,r,a,l,s,i,u,c,E,f,T,g,h,M){return e[0]=t,e[1]=n,e[2]=o,e[3]=r,e[4]=a,e[5]=l,e[6]=s,e[7]=i,e[8]=u,e[9]=c,e[10]=E,e[11]=f,e[12]=T,e[13]=g,e[14]=h,e[15]=M,e}function c(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function E(e,t){if(e===t){const n=t[1],o=t[2],r=t[3],a=t[6],l=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=o,e[9]=a,e[11]=t[14],e[12]=r,e[13]=l,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function f(e,t){const n=t[0],o=t[1],r=t[2],a=t[3],l=t[4],s=t[5],i=t[6],u=t[7],c=t[8],E=t[9],f=t[10],T=t[11],g=t[12],h=t[13],M=t[14],d=t[15],k=n*s-o*l,p=n*i-r*l,L=n*u-a*l,m=o*i-r*s,R=o*u-a*s,I=r*u-a*i,A=c*h-E*g,S=c*M-f*g,O=c*d-T*g,P=E*M-f*h,N=E*d-T*h,_=f*d-T*M;let v=k*_-p*N+L*P+m*O-R*S+I*A;return v?(v=1/v,e[0]=(s*_-i*N+u*P)*v,e[1]=(r*N-o*_-a*P)*v,e[2]=(h*I-M*R+d*m)*v,e[3]=(f*R-E*I-T*m)*v,e[4]=(i*O-l*_-u*S)*v,e[5]=(n*_-r*O+a*S)*v,e[6]=(M*L-g*I-d*p)*v,e[7]=(c*I-f*L+T*p)*v,e[8]=(l*N-s*O+u*A)*v,e[9]=(o*O-n*N-a*A)*v,e[10]=(g*R-h*L+d*k)*v,e[11]=(E*L-c*R-T*k)*v,e[12]=(s*S-l*P-i*A)*v,e[13]=(n*P-o*S+r*A)*v,e[14]=(h*p-g*m-M*k)*v,e[15]=(c*m-E*p+f*k)*v,e):null}function T(e,t){const n=t[0],o=t[1],r=t[2],a=t[3],l=t[4],s=t[5],i=t[6],u=t[7],c=t[8],E=t[9],f=t[10],T=t[11],g=t[12],h=t[13],M=t[14],d=t[15],k=n*s-o*l,p=n*i-r*l,L=n*u-a*l,m=o*i-r*s,R=o*u-a*s,I=r*u-a*i,A=c*h-E*g,S=c*M-f*g,O=c*d-T*g,P=E*M-f*h,N=E*d-T*h,_=f*d-T*M;return e[0]=s*_-i*N+u*P,e[1]=r*N-o*_-a*P,e[2]=h*I-M*R+d*m,e[3]=f*R-E*I-T*m,e[4]=i*O-l*_-u*S,e[5]=n*_-r*O+a*S,e[6]=M*L-g*I-d*p,e[7]=c*I-f*L+T*p,e[8]=l*N-s*O+u*A,e[9]=o*O-n*N-a*A,e[10]=g*R-h*L+d*k,e[11]=E*L-c*R-T*k,e[12]=s*S-l*P-i*A,e[13]=n*P-o*S+r*A,e[14]=h*p-g*m-M*k,e[15]=c*m-E*p+f*k,e}function g(e){const t=e[0],n=e[1],o=e[2],r=e[3],a=e[4],l=e[5],s=e[6],i=e[7],u=e[8],c=e[9],E=e[10],f=e[11],T=e[12],g=e[13],h=e[14],M=t*l-n*a,d=t*s-o*a,k=n*s-o*l,p=u*g-c*T,L=u*h-E*T,m=c*h-E*g;return i*(t*m-n*L+o*p)-r*(a*m-l*L+s*p)+e[15]*(u*k-c*d+E*M)-f*(T*k-g*d+h*M)}function h(e,t,n){const o=t[0],r=t[1],a=t[2],l=t[3],s=t[4],i=t[5],u=t[6],c=t[7],E=t[8],f=t[9],T=t[10],g=t[11],h=t[12],M=t[13],d=t[14],k=t[15];let p=n[0],L=n[1],m=n[2],R=n[3];return e[0]=p*o+L*s+m*E+R*h,e[1]=p*r+L*i+m*f+R*M,e[2]=p*a+L*u+m*T+R*d,e[3]=p*l+L*c+m*g+R*k,p=n[4],L=n[5],m=n[6],R=n[7],e[4]=p*o+L*s+m*E+R*h,e[5]=p*r+L*i+m*f+R*M,e[6]=p*a+L*u+m*T+R*d,e[7]=p*l+L*c+m*g+R*k,p=n[8],L=n[9],m=n[10],R=n[11],e[8]=p*o+L*s+m*E+R*h,e[9]=p*r+L*i+m*f+R*M,e[10]=p*a+L*u+m*T+R*d,e[11]=p*l+L*c+m*g+R*k,p=n[12],L=n[13],m=n[14],R=n[15],e[12]=p*o+L*s+m*E+R*h,e[13]=p*r+L*i+m*f+R*M,e[14]=p*a+L*u+m*T+R*d,e[15]=p*l+L*c+m*g+R*k,e}function M(e,t,n){const o=n[0],r=n[1],a=n[2];let l,s,i,u,c,E,f,T,g,h,M,d;return t===e?(e[12]=t[0]*o+t[4]*r+t[8]*a+t[12],e[13]=t[1]*o+t[5]*r+t[9]*a+t[13],e[14]=t[2]*o+t[6]*r+t[10]*a+t[14],e[15]=t[3]*o+t[7]*r+t[11]*a+t[15]):(l=t[0],s=t[1],i=t[2],u=t[3],c=t[4],E=t[5],f=t[6],T=t[7],g=t[8],h=t[9],M=t[10],d=t[11],e[0]=l,e[1]=s,e[2]=i,e[3]=u,e[4]=c,e[5]=E,e[6]=f,e[7]=T,e[8]=g,e[9]=h,e[10]=M,e[11]=d,e[12]=l*o+c*r+g*a+t[12],e[13]=s*o+E*r+h*a+t[13],e[14]=i*o+f*r+M*a+t[14],e[15]=u*o+T*r+d*a+t[15]),e}function d(e,t,n){const o=n[0],r=n[1],a=n[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function k(e,t,n,r){let a,l,s,i,u,c,E,f,T,g,h,M,d,k,p,L,m,R,I,A,S,O,P,N,_=r[0],v=r[1],U=r[2],C=Math.hypot(_,v,U);return C<o?null:(C=1/C,_*=C,v*=C,U*=C,a=Math.sin(n),l=Math.cos(n),s=1-l,i=t[0],u=t[1],c=t[2],E=t[3],f=t[4],T=t[5],g=t[6],h=t[7],M=t[8],d=t[9],k=t[10],p=t[11],L=_*_*s+l,m=v*_*s+U*a,R=U*_*s-v*a,I=_*v*s-U*a,A=v*v*s+l,S=U*v*s+_*a,O=_*U*s+v*a,P=v*U*s-_*a,N=U*U*s+l,e[0]=i*L+f*m+M*R,e[1]=u*L+T*m+d*R,e[2]=c*L+g*m+k*R,e[3]=E*L+h*m+p*R,e[4]=i*I+f*A+M*S,e[5]=u*I+T*A+d*S,e[6]=c*I+g*A+k*S,e[7]=E*I+h*A+p*S,e[8]=i*O+f*P+M*N,e[9]=u*O+T*P+d*N,e[10]=c*O+g*P+k*N,e[11]=E*O+h*P+p*N,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function p(e,t,n){const o=Math.sin(n),r=Math.cos(n),a=t[4],l=t[5],s=t[6],i=t[7],u=t[8],c=t[9],E=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*r+u*o,e[5]=l*r+c*o,e[6]=s*r+E*o,e[7]=i*r+f*o,e[8]=u*r-a*o,e[9]=c*r-l*o,e[10]=E*r-s*o,e[11]=f*r-i*o,e}function L(e,t,n){const o=Math.sin(n),r=Math.cos(n),a=t[0],l=t[1],s=t[2],i=t[3],u=t[8],c=t[9],E=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r-u*o,e[1]=l*r-c*o,e[2]=s*r-E*o,e[3]=i*r-f*o,e[8]=a*o+u*r,e[9]=l*o+c*r,e[10]=s*o+E*r,e[11]=i*o+f*r,e}function m(e,t,n){const o=Math.sin(n),r=Math.cos(n),a=t[0],l=t[1],s=t[2],i=t[3],u=t[4],c=t[5],E=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*r+u*o,e[1]=l*r+c*o,e[2]=s*r+E*o,e[3]=i*r+f*o,e[4]=u*r-a*o,e[5]=c*r-l*o,e[6]=E*r-s*o,e[7]=f*r-i*o,e}function R(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function I(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A(e,t,n){let r,a,l,s=n[0],i=n[1],u=n[2],c=Math.hypot(s,i,u);return c<o?null:(c=1/c,s*=c,i*=c,u*=c,r=Math.sin(t),a=Math.cos(t),l=1-a,e[0]=s*s*l+a,e[1]=i*s*l+u*r,e[2]=u*s*l-i*r,e[3]=0,e[4]=s*i*l-u*r,e[5]=i*i*l+a,e[6]=u*i*l+s*r,e[7]=0,e[8]=s*u*l+i*r,e[9]=i*u*l-s*r,e[10]=u*u*l+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function S(e,t){const n=Math.sin(t),o=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function O(e,t){const n=Math.sin(t),o=Math.cos(t);return e[0]=o,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function P(e,t){const n=Math.sin(t),o=Math.cos(t);return e[0]=o,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function N(e,t,n){const o=t[0],r=t[1],a=t[2],l=t[3],s=o+o,i=r+r,u=a+a,c=o*s,E=o*i,f=o*u,T=r*i,g=r*u,h=a*u,M=l*s,d=l*i,k=l*u;return e[0]=1-(T+h),e[1]=E+k,e[2]=f-d,e[3]=0,e[4]=E-k,e[5]=1-(c+h),e[6]=g+M,e[7]=0,e[8]=f+d,e[9]=g-M,e[10]=1-(c+T),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function _(e,t){const n=new r(3),o=-t[0],a=-t[1],l=-t[2],s=t[3],i=t[4],u=t[5],c=t[6],E=t[7],f=o*o+a*a+l*l+s*s;return f>0?(n[0]=2*(i*s+E*o+u*l-c*a)/f,n[1]=2*(u*s+E*a+c*o-i*l)/f,n[2]=2*(c*s+E*l+i*a-u*o)/f):(n[0]=2*(i*s+E*o+u*l-c*a),n[1]=2*(u*s+E*a+c*o-i*l),n[2]=2*(c*s+E*l+i*a-u*o)),N(e,t,n),e}function v(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function U(e,t){const n=t[0],o=t[1],r=t[2],a=t[4],l=t[5],s=t[6],i=t[8],u=t[9],c=t[10];return e[0]=Math.hypot(n,o,r),e[1]=Math.hypot(a,l,s),e[2]=Math.hypot(i,u,c),e}function C(e,t){const n=new r(3);U(n,t);const o=1/n[0],a=1/n[1],l=1/n[2],s=t[0]*o,i=t[1]*a,u=t[2]*l,c=t[4]*o,E=t[5]*a,f=t[6]*l,T=t[8]*o,g=t[9]*a,h=t[10]*l,M=s+E+h;let d=0;return M>0?(d=2*Math.sqrt(M+1),e[3]=.25*d,e[0]=(f-g)/d,e[1]=(T-u)/d,e[2]=(i-c)/d):s>E&&s>h?(d=2*Math.sqrt(1+s-E-h),e[3]=(f-g)/d,e[0]=.25*d,e[1]=(i+c)/d,e[2]=(T+u)/d):E>h?(d=2*Math.sqrt(1+E-s-h),e[3]=(T-u)/d,e[0]=(i+c)/d,e[1]=.25*d,e[2]=(f+g)/d):(d=2*Math.sqrt(1+h-s-E),e[3]=(i-c)/d,e[0]=(T+u)/d,e[1]=(f+g)/d,e[2]=.25*d),e}function F(e,t,n,o){t[0]=o[12],t[1]=o[13],t[2]=o[14];const r=o[0],a=o[1],l=o[2],s=o[4],i=o[5],u=o[6],c=o[8],E=o[9],f=o[10];n[0]=Math.hypot(r,a,l),n[1]=Math.hypot(s,i,u),n[2]=Math.hypot(c,E,f);const T=1/n[0],g=1/n[1],h=1/n[2],M=r*T,d=a*g,k=l*h,p=s*T,L=i*g,m=u*h,R=c*T,I=E*g,A=f*h,S=M+L+A;let O=0;return S>0?(O=2*Math.sqrt(S+1),e[3]=.25*O,e[0]=(m-I)/O,e[1]=(R-k)/O,e[2]=(d-p)/O):M>L&&M>A?(O=2*Math.sqrt(1+M-L-A),e[3]=(m-I)/O,e[0]=.25*O,e[1]=(d+p)/O,e[2]=(R+k)/O):L>A?(O=2*Math.sqrt(1+L-M-A),e[3]=(R-k)/O,e[0]=(d+p)/O,e[1]=.25*O,e[2]=(m+I)/O):(O=2*Math.sqrt(1+A-M-L),e[3]=(d-p)/O,e[0]=(R+k)/O,e[1]=(m+I)/O,e[2]=.25*O),e}function b(e,t,n,o){const r=t[0],a=t[1],l=t[2],s=t[3],i=r+r,u=a+a,c=l+l,E=r*i,f=r*u,T=r*c,g=a*u,h=a*c,M=l*c,d=s*i,k=s*u,p=s*c,L=o[0],m=o[1],R=o[2];return e[0]=(1-(g+M))*L,e[1]=(f+p)*L,e[2]=(T-k)*L,e[3]=0,e[4]=(f-p)*m,e[5]=(1-(E+M))*m,e[6]=(h+d)*m,e[7]=0,e[8]=(T+k)*R,e[9]=(h-d)*R,e[10]=(1-(E+g))*R,e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}function x(e,t,n,o,r){const a=t[0],l=t[1],s=t[2],i=t[3],u=a+a,c=l+l,E=s+s,f=a*u,T=a*c,g=a*E,h=l*c,M=l*E,d=s*E,k=i*u,p=i*c,L=i*E,m=o[0],R=o[1],I=o[2],A=r[0],S=r[1],O=r[2],P=(1-(h+d))*m,N=(T+L)*m,_=(g-p)*m,v=(T-L)*R,U=(1-(f+d))*R,C=(M+k)*R,F=(g+p)*I,b=(M-k)*I,x=(1-(f+h))*I;return e[0]=P,e[1]=N,e[2]=_,e[3]=0,e[4]=v,e[5]=U,e[6]=C,e[7]=0,e[8]=F,e[9]=b,e[10]=x,e[11]=0,e[12]=n[0]+A-(P*A+v*S+F*O),e[13]=n[1]+S-(N*A+U*S+b*O),e[14]=n[2]+O-(_*A+C*S+x*O),e[15]=1,e}function D(e,t){const n=t[0],o=t[1],r=t[2],a=t[3],l=n+n,s=o+o,i=r+r,u=n*l,c=o*l,E=o*s,f=r*l,T=r*s,g=r*i,h=a*l,M=a*s,d=a*i;return e[0]=1-E-g,e[1]=c+d,e[2]=f-M,e[3]=0,e[4]=c-d,e[5]=1-u-g,e[6]=T+h,e[7]=0,e[8]=f+M,e[9]=T-h,e[10]=1-u-E,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function B(e,t,n,o,r,a,l){const s=1/(n-t),i=1/(r-o),u=1/(a-l);return e[0]=2*a*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*i,e[6]=0,e[7]=0,e[8]=(n+t)*s,e[9]=(r+o)*i,e[10]=(l+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=l*a*2*u,e[15]=0,e}function y(e,t,n,o,r){const a=1/Math.tan(t/2);if(e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0){const t=1/(o-r);e[10]=(r+o)*t,e[14]=2*r*o*t}else e[10]=-1,e[14]=-2*o;return e}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){let e=0,t=arguments.length;for(;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var G=y;function w(e,t,n,o,r){const a=1/Math.tan(t/2);if(e[0]=a/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=r&&r!==1/0){const t=1/(o-r);e[10]=r*t,e[14]=r*o*t}else e[10]=-1,e[14]=-o;return e}function V(e,t,n,o){const r=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),l=Math.tan(t.leftDegrees*Math.PI/180),s=Math.tan(t.rightDegrees*Math.PI/180),i=2/(l+s),u=2/(r+a);return e[0]=i,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=u,e[6]=0,e[7]=0,e[8]=-(l-s)*i*.5,e[9]=(r-a)*u*.5,e[10]=o/(n-o),e[11]=-1,e[12]=0,e[13]=0,e[14]=o*n/(n-o),e[15]=0,e}function $(e,t,n,o,r,a,l){const s=1/(t-n),i=1/(o-r),u=1/(a-l);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+n)*s,e[13]=(r+o)*i,e[14]=(l+a)*u,e[15]=1,e}var X=$;function Q(e,t,n,o,r,a,l){const s=1/(t-n),i=1/(o-r),u=1/(a-l);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=u,e[11]=0,e[12]=(t+n)*s,e[13]=(r+o)*i,e[14]=a*u,e[15]=1,e}function H(e,t,n,r){let a,l,s,i,u,E,f,T,g,h;const M=t[0],d=t[1],k=t[2],p=r[0],L=r[1],m=r[2],R=n[0],I=n[1],A=n[2];return Math.abs(M-R)<o&&Math.abs(d-I)<o&&Math.abs(k-A)<o?c(e):(f=M-R,T=d-I,g=k-A,h=1/Math.hypot(f,T,g),f*=h,T*=h,g*=h,a=L*g-m*T,l=m*f-p*g,s=p*T-L*f,h=Math.hypot(a,l,s),h?(h=1/h,a*=h,l*=h,s*=h):(a=0,l=0,s=0),i=T*s-g*l,u=g*a-f*s,E=f*l-T*a,h=Math.hypot(i,u,E),h?(h=1/h,i*=h,u*=h,E*=h):(i=0,u=0,E=0),e[0]=a,e[1]=i,e[2]=f,e[3]=0,e[4]=l,e[5]=u,e[6]=T,e[7]=0,e[8]=s,e[9]=E,e[10]=g,e[11]=0,e[12]=-(a*M+l*d+s*k),e[13]=-(i*M+u*d+E*k),e[14]=-(f*M+T*d+g*k),e[15]=1,e)}function q(e,t,n,o){const r=t[0],a=t[1],l=t[2],s=o[0],i=o[1],u=o[2];let c=r-n[0],E=a-n[1],f=l-n[2],T=c*c+E*E+f*f;T>0&&(T=1/Math.sqrt(T),c*=T,E*=T,f*=T);let g=i*f-u*E,h=u*c-s*f,M=s*E-i*c;return T=g*g+h*h+M*M,T>0&&(T=1/Math.sqrt(T),g*=T,h*=T,M*=T),e[0]=g,e[1]=h,e[2]=M,e[3]=0,e[4]=E*M-f*h,e[5]=f*g-c*M,e[6]=c*h-E*g,e[7]=0,e[8]=c,e[9]=E,e[10]=f,e[11]=0,e[12]=r,e[13]=a,e[14]=l,e[15]=1,e}function W(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function Y(e){return Math.hypot(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])}function j(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e[4]=t[4]+n[4],e[5]=t[5]+n[5],e[6]=t[6]+n[6],e[7]=t[7]+n[7],e[8]=t[8]+n[8],e[9]=t[9]+n[9],e[10]=t[10]+n[10],e[11]=t[11]+n[11],e[12]=t[12]+n[12],e[13]=t[13]+n[13],e[14]=t[14]+n[14],e[15]=t[15]+n[15],e}function K(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e[4]=t[4]-n[4],e[5]=t[5]-n[5],e[6]=t[6]-n[6],e[7]=t[7]-n[7],e[8]=t[8]-n[8],e[9]=t[9]-n[9],e[10]=t[10]-n[10],e[11]=t[11]-n[11],e[12]=t[12]-n[12],e[13]=t[13]-n[13],e[14]=t[14]-n[14],e[15]=t[15]-n[15],e}function z(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12]*n,e[13]=t[13]*n,e[14]=t[14]*n,e[15]=t[15]*n,e}function J(e,t,n,o){return e[0]=t[0]+n[0]*o,e[1]=t[1]+n[1]*o,e[2]=t[2]+n[2]*o,e[3]=t[3]+n[3]*o,e[4]=t[4]+n[4]*o,e[5]=t[5]+n[5]*o,e[6]=t[6]+n[6]*o,e[7]=t[7]+n[7]*o,e[8]=t[8]+n[8]*o,e[9]=t[9]+n[9]*o,e[10]=t[10]+n[10]*o,e[11]=t[11]+n[11]*o,e[12]=t[12]+n[12]*o,e[13]=t[13]+n[13]*o,e[14]=t[14]+n[14]*o,e[15]=t[15]+n[15]*o,e}function Z(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function ee(e,t){const n=e[0],r=e[1],a=e[2],l=e[3],s=e[4],i=e[5],u=e[6],c=e[7],E=e[8],f=e[9],T=e[10],g=e[11],h=e[12],M=e[13],d=e[14],k=e[15],p=t[0],L=t[1],m=t[2],R=t[3],I=t[4],A=t[5],S=t[6],O=t[7],P=t[8],N=t[9],_=t[10],v=t[11],U=t[12],C=t[13],F=t[14],b=t[15];return Math.abs(n-p)<=o*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-L)<=o*Math.max(1,Math.abs(r),Math.abs(L))&&Math.abs(a-m)<=o*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-R)<=o*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(s-I)<=o*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(i-A)<=o*Math.max(1,Math.abs(i),Math.abs(A))&&Math.abs(u-S)<=o*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-O)<=o*Math.max(1,Math.abs(c),Math.abs(O))&&Math.abs(E-P)<=o*Math.max(1,Math.abs(E),Math.abs(P))&&Math.abs(f-N)<=o*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(T-_)<=o*Math.max(1,Math.abs(T),Math.abs(_))&&Math.abs(g-v)<=o*Math.max(1,Math.abs(g),Math.abs(v))&&Math.abs(h-U)<=o*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(M-C)<=o*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(d-F)<=o*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(k-b)<=o*Math.max(1,Math.abs(k),Math.abs(b))}var te=h,ne=K}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={exports:{}};return e[o].call(a.exports,a,a.exports,n),a.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n(607)})();